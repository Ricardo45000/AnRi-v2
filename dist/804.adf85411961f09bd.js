"use strict";(self.webpackChunkpd_pro_angularcli=self.webpackChunkpd_pro_angularcli||[]).push([[804],{4804:(R,d,o)=>{o.r(d),o.d(d,{DashboardModule:()=>y});var c=o(776),v=o(6814),u=o(95),l=o(5861),g=o(9519),h=o.n(g),p=o(1598),e=o(9468);let m=(()=>{class n{airtableService;records=[];constructor(t){this.airtableService=t}getChartData(t){var i=this;return(0,l.Z)(function*(){return i.records=yield i.airtableService.getRecords(),i.generateChartData(t)})()}generateChartData(t){var r=t.createLinearGradient(0,20,0,300);return r.addColorStop(0,"#6bd098"),r.addColorStop(1,"#FFFFFF"),{labels:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],datasets:[{label:"Number of Reviews",borderColor:"#6bd098",backgroundColor:r,pointRadius:5,pointHoverRadius:10,fill:!0,borderWidth:3,data:this.countDatesForEachMonth()}]}}countDatesForEachMonth(){const t=(new Date).getFullYear();return this.records.filter(r=>new Date(r.date).getFullYear()===t).map(r=>new Date(r.date).getMonth()).reduce((r,a)=>(r[a]++,r),new Array(12).fill(0))}calculateAverageStars(){const t=this.records.map(a=>a.rating).filter(a=>!isNaN(a)),i=t.reduce((a,s)=>a+s,0),r=t.length;return Number(r>0?i/r:0).toFixed(2)}counterStarsRating(t){return this.records.map(i=>i.rating).filter(i=>i===t).length}numberOfComments(){const t=(new Date).getFullYear();return this.records.map(a=>new Date(a.date).getFullYear()).reduce((a,s)=>a+(s===t?1:0),0)}categoryToImprove(){const t={};this.records.map(a=>{const s=a.category.toLowerCase();return s.charAt(0).toUpperCase()+s.slice(1)}).reduce((a,s)=>(a[s]=(a[s]||0)+1,a),t);const[r]=Object.entries(t).reduce((a,s)=>s[1]>a[1]?s:a,["",-1/0]);return r||null}static \u0275fac=function(i){return new(i||n)(e.LFG(p.R))};static \u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var f=o(5618),b=o(3276),C=o(7870);const Z=[{path:"",children:[{path:"dashboard",component:(()=>{class n{sharedService;dashboardService;authService;router;resolver;viewContainerRef;constructor(t,i,r,a,s,S){this.sharedService=t,this.dashboardService=i,this.authService=r,this.router=a,this.resolver=s,this.viewContainerRef=S}isLoading=!1;canvas;ctx;chartData;regularTableComponentRef;ngOnInit(){this.authService.checkConnection()?(this.isLoading=!0,this.initializeChart(),this.loadData(),this.initiateRegularTableComponent(),this.isLoading=!1):this.router.navigate(["/pages/lock"])}initiateRegularTableComponent(){const t=this.resolver.resolveComponentFactory(b.z);this.regularTableComponentRef=this.viewContainerRef.createComponent(t);const i=this.regularTableComponentRef.instance;i.ngOnInit(),i.filterByRating(5)}initializeChart(){this.canvas=document.getElementById("activeUsers"),this.ctx=this.canvas.getContext("2d")}loadData(){var t=this;return(0,l.Z)(function*(){t.chartData=yield t.dashboardService.getChartData(t.ctx),t.createChart()})()}createChart(){new(h())(this.ctx,{type:"line",data:this.chartData,options:{legend:{display:!0},tooltips:{enabled:!0},scales:{yAxes:[{ticks:{fontColor:"#9f9f9f",beginAtZero:!0,maxTicksLimit:10},gridLines:{drawBorder:!1,zeroLineColor:"transparent",color:"rgba(255,255,255,0.05)"}}],dataset:[{barPercentage:1.6,gridLines:{drawBorder:!0,color:"rgba(255,255,255,0.1)",zeroLineColor:"transparent",display:!0},ticks:{padding:20,fontColor:"#9f9f9f"}}]}}})}calculateAverageStars(){return this.dashboardService.calculateAverageStars()}counterStarsRating(t){return this.dashboardService.counterStarsRating(t)}currentYear(){return(new Date).getFullYear()}numberOfComments(){return this.dashboardService.numberOfComments()}filterRating(t){this.router.navigate(["/tables/all"]),this.sharedService.sendFilterRating(t)}filterCategory(t){this.router.navigate(["/tables/all"]),this.sharedService.sendFilterCategory(t)}categoryToImprove(){return this.dashboardService.categoryToImprove()}static \u0275fac=function(i){return new(i||n)(e.Y36(C.F),e.Y36(m),e.Y36(f.q),e.Y36(c.F0),e.Y36(e._Vd),e.Y36(e.s_b))};static \u0275cmp=e.Xpm({type:n,selectors:[["app-dashboard"]],decls:111,vars:9,consts:[[1,"main-content"],[1,"row"],[1,"col-lg-6"],[1,"card","card-stats"],["onclick","window.location.href='#/advanced'",1,"card-body","star-clickable"],[1,"col-6","col-md-6"],[1,"icon-big","text-center","icon-warning"],[1,"fas","fa-balance-scale","text-warning"],[1,"col-6","col-md-6","d-flex","align-items-center","justify-content-center","mx-auto"],[1,"numbers","text-center","mx-auto"],[1,"card-category"],[1,"card-title"],[1,"card-body","star-clickable",3,"click"],[1,"fas","fa-glasses","text-warning"],[1,"col-6","col-md-6",2,"font-size","35%"],[1,"fas","fa-star","text-warning"],[1,"col-lg-4"],[1,"col-md-12"],[1,"card"],[1,"card-header"],[1,"col-sm-7"],[1,"numbers","pull-left"],[1,"col-sm-5"],[1,"pull-right"],["onclick","window.location.href='#/advanced'",1,"badge","badge-pill","badge-success","star-clickable"],[1,"card-body"],[1,"big-title"],["id","activeUsers","height","100%"]],template:function(i,r){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",1)(6,"div",5)(7,"div",6),e._UZ(8,"i",7),e.qZA()(),e.TgZ(9,"div",8)(10,"div",9)(11,"p",10),e._uU(12,"Average"),e.qZA(),e.TgZ(13,"p",11),e._uU(14),e.qZA()()()()()(),e.TgZ(15,"div",3)(16,"div",12),e.NdJ("click",function(){return r.filterCategory(r.categoryToImprove())}),e.TgZ(17,"div",1)(18,"div",5)(19,"div",6),e._UZ(20,"i",13),e.qZA()(),e.TgZ(21,"div",8)(22,"div",9)(23,"p",10),e._uU(24,"Improvement"),e.qZA(),e.TgZ(25,"p",11),e._uU(26),e.qZA()()()()()()(),e.TgZ(27,"div",2)(28,"div",1)(29,"div",2)(30,"div",3)(31,"div",12),e.NdJ("click",function(){return r.filterRating(5)}),e.TgZ(32,"div",1)(33,"div",14)(34,"div",6),e._UZ(35,"i",15)(36,"i",15)(37,"i",15)(38,"i",15)(39,"i",15),e.qZA()(),e.TgZ(40,"div",8)(41,"div",9)(42,"p",11),e._uU(43),e.qZA()()()()()()(),e.TgZ(44,"div",2)(45,"div",3)(46,"div",12),e.NdJ("click",function(){return r.filterRating(4)}),e.TgZ(47,"div",1)(48,"div",14)(49,"div",6),e._UZ(50,"i",15)(51,"i",15)(52,"i",15)(53,"i",15),e.qZA()(),e.TgZ(54,"div",8)(55,"div",9)(56,"p",11),e._uU(57),e.qZA()()()()()()()(),e.TgZ(58,"div",1)(59,"div",16)(60,"div",3)(61,"div",12),e.NdJ("click",function(){return r.filterRating(3)}),e.TgZ(62,"div",1)(63,"div",14)(64,"div",6),e._UZ(65,"i",15)(66,"i",15)(67,"i",15),e.qZA()(),e.TgZ(68,"div",8)(69,"div",9)(70,"p",11),e._uU(71),e.qZA()()()()()()(),e.TgZ(72,"div",16)(73,"div",3)(74,"div",12),e.NdJ("click",function(){return r.filterRating(2)}),e.TgZ(75,"div",1)(76,"div",14)(77,"div",6),e._UZ(78,"i",15)(79,"i",15),e.qZA()(),e.TgZ(80,"div",8)(81,"div",9)(82,"p",11),e._uU(83),e.qZA()()()()()()(),e.TgZ(84,"div",16)(85,"div",3)(86,"div",12),e.NdJ("click",function(){return r.filterRating(1)}),e.TgZ(87,"div",1)(88,"div",14)(89,"div",6),e._UZ(90,"i",15),e.qZA()(),e.TgZ(91,"div",8)(92,"div",9)(93,"p",11),e._uU(94),e.qZA()()()()()()()()()(),e.TgZ(95,"div",1)(96,"div",17)(97,"div",18)(98,"div",19)(99,"div",1)(100,"div",20)(101,"div",21),e._uU(102),e.qZA()(),e.TgZ(103,"div",22)(104,"div",23)(105,"span",24),e._uU(106," Comparison "),e.qZA()()()()(),e.TgZ(107,"div",25)(108,"h6",26),e._uU(109),e.qZA(),e._UZ(110,"canvas",27),e.qZA()()()()()),2&i&&(e.xp6(14),e.Oqu(r.calculateAverageStars()),e.xp6(12),e.Oqu(r.categoryToImprove()),e.xp6(17),e.Oqu(r.counterStarsRating(5)),e.xp6(14),e.Oqu(r.counterStarsRating(4)),e.xp6(14),e.hij("",r.counterStarsRating(3)," "),e.xp6(12),e.Oqu(r.counterStarsRating(2)),e.xp6(11),e.hij("",r.counterStarsRating(1)," "),e.xp6(8),e.hij(" ",r.numberOfComments()," "),e.xp6(7),e.hij("total amount of reviews in ",r.currentYear(),""))},encapsulation:2})}return n})()}]}];var T=o(9106);let y=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=e.oAB({type:n});static \u0275inj=e.cJS({imports:[T.q.forRoot({}),v.ez,c.Bz.forChild(Z),u.u5]})}return n})()}}]);
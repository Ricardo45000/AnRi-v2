"use strict";(self.webpackChunkpd_pro_angularcli=self.webpackChunkpd_pro_angularcli||[]).push([[592],{7870:(R,g,r)=>{r.d(g,{F:()=>f});var d=r(8645),b=r(9468);let f=(()=>{class e{filterRatingSubject=new d.x;filterCategorySubject=new d.x;filterRating$=this.filterRatingSubject.asObservable();filterCategory$=this.filterCategorySubject.asObservable();sendFilterRating(s){console.log("hello1"),this.filterRatingSubject.next(s)}sendFilterCategory(s){this.filterCategorySubject.next(s)}static \u0275fac=function(_){return new(_||e)};static \u0275prov=b.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})()},3276:(R,g,r)=>{r.d(g,{z:()=>E});var d=r(5861),b=r(1598),f=r(5618),e=r(9468),O=r(776),s=r(7870),_=r(6814);function C(o,m){if(1&o&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA()()),2&o){const t=m.$implicit;e.xp6(2),e.Oqu(t[0]),e.xp6(2),e.Oqu(t[1]),e.xp6(2),e.Oqu(t[2]),e.xp6(2),e.Oqu(t[3])}}function D(o,m){if(1&o&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"h4",6),e._uU(6,"All Details"),e.qZA()(),e.TgZ(7,"div",7)(8,"table",8)(9,"thead")(10,"tr")(11,"th"),e._uU(12),e.qZA(),e.TgZ(13,"th"),e._uU(14),e.qZA(),e.TgZ(15,"th"),e._uU(16),e.qZA(),e.TgZ(17,"th"),e._uU(18),e.qZA()()(),e.TgZ(19,"tbody"),e.YNc(20,C,9,4,"tr",9),e.qZA()()()()()()()),2&o){const t=e.oxw();e.xp6(12),e.Oqu(null==t.dataTable?null:t.dataTable.headerRow[0]),e.xp6(2),e.Oqu(null==t.dataTable?null:t.dataTable.headerRow[1]),e.xp6(2),e.Oqu(null==t.dataTable?null:t.dataTable.headerRow[2]),e.xp6(2),e.Oqu(null==t.dataTable?null:t.dataTable.headerRow[3]),e.xp6(2),e.Q6J("ngForOf",null==t.dataTable?null:t.dataTable.dataRows)}}let E=(()=>{class o{airtableService;router;authService;sharedService;dataTable={headerRow:[],dataRows:[]};dtInstance;constructor(t,a,n,l){this.airtableService=t,this.router=a,this.authService=n,this.sharedService=l}convertToDataTable(t){return{headerRow:Object.keys(t[0]),dataRows:t.map(l=>Object.values(l).map(i=>null!=i&&""!==i?i.toString().replace(/[\r\n]+/g,"\n"):"\n"))}}ngOnInit(){this.authService.checkConnection()?(this.sharedService.filterRating$.subscribe(t=>{console.log("hello"),this.filterByRating(t)}),this.sharedService.filterCategory$.subscribe(t=>{this.filterByCategory(t)}),this.airtableService.getRecords().then(t=>{t&&t.length>0?this.dataTable=this.convertToDataTable(t):console.error("No records found.")}).catch(t=>{console.error("Error fetching records:",t)})):this.router.navigate(["/pages/lock"])}ngAfterViewInit(){setTimeout(()=>{this.initDataTable()})}initDataTable(){return new Promise(t=>{const a=()=>{this.dataTable.dataRows.length>0?this.dtInstance=$("#datatable").DataTable({pagingType:"full_numbers",lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],order:[[this.dataTable.headerRow.indexOf("date"),"desc"]],responsive:!0,language:{search:"_INPUT_",searchPlaceholder:"Search records"},initComplete:function(){const n=this.api(),l=$(n.table().header()).closest("thead")[0].insertRow(-1);n.columns().every(function(i){const u=this,T=l.insertCell(-1);if($(T).addClass("header-filter-cell"),"rating"===u.header().textContent||"category"===u.header().textContent){const c=document.createElement("select");c.id=u.header().textContent.toLowerCase();const w=Array.from(new Set(n.column(i).data().toArray())).sort(),p=document.createElement("option");p.text="All",p.value="",c.add(p),w.forEach(h=>{const v=document.createElement("option");v.text=h,v.value=h,c.add(v)}),$(c).appendTo($(T)).on("change",function(){const h=$.fn.dataTable.util.escapeRegex($(this).val());u.search(h?`^${h}$`:"",!0,!1).draw()}).css("width","100%")}else{const c=document.createElement("input");$(c).appendTo($(T)).on("keyup change",function(){u.search($(this).val()).draw()}).attr("placeholder",n.column(i).header().textContent).css("width","100%")}}),$("#datatable_wrapper").css("overflow","auto"),t()}}):setTimeout(a,100)};a()})}filterByRating(t){var a=this;return(0,d.Z)(function*(){if(console.log("1"),yield a.waitForDataTableInit(),a.dtInstance){const l=$("#rating");l.length>0?l.val(t.toString()).trigger("change"):console.error("Rating filter select element not found.")}else console.error("DataTable instance not defined.")})()}filterByCategory(t){var a=this;return(0,d.Z)(function*(){if(console.log("1"),yield a.waitForDataTableInit(),a.dtInstance){const l=$("#category");l.length>0?l.val(t.toString()).trigger("change"):console.error("Category filter select element not found.")}else console.error("DataTable instance not defined.")})()}waitForDataTableInit(){return new Promise(t=>{const a=setInterval(()=>{($.fn.DataTable.isDataTable("#datatable")?$("#datatable").DataTable():void 0)&&(clearInterval(a),t())},100)})}static \u0275fac=function(a){return new(a||o)(e.Y36(b.R),e.Y36(O.F0),e.Y36(f.q),e.Y36(s.F))};static \u0275cmp=e.Xpm({type:o,selectors:[["regular-table-cmp"]],decls:1,vars:1,consts:[["class","main-content",4,"ngIf"],[1,"main-content"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],["id","datatable","cellspacing","0","width","100%",1,"hover","table","table-striped","table-bordered"],[4,"ngFor","ngForOf"]],template:function(a,n){1&a&&e.YNc(0,D,21,5,"div",0),2&a&&e.Q6J("ngIf",n.dataTable&&n.dataTable.dataRows.length>0)},dependencies:[_.sg,_.O5],encapsulation:2})}return o})()}}]);
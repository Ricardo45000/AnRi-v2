"use strict";(self.webpackChunkpd_pro_angularcli=self.webpackChunkpd_pro_angularcli||[]).push([[722],{722:(L,b,c)=>{c.r(b),c.d(b,{ChartsModule:()=>I});var f=c(776),g=c(6814),p=c(95),W=c(9519),C=c.n(W),w=c(1598),D=c(5618),t=c(9468);let Z=(()=>{class i{constructor(){}mixLists(e,a){const n=Math.min(e.length,a.length),s=Array.from({length:n}).map((r,o)=>`${e[o]} / ${a[o]}`).reduce((r,o)=>(r.push(o),r),[]),d=e.slice(n).map(r=>`${r} / -`),l=a.slice(n).map(r=>`- / ${r}`);return s.concat(d,l)}getLabelForDataset(e){return e[0]+" to "+e.pop()}getISOWeek(e){const a=new Date(e);a.setDate(a.getDate()+4-(a.getDay()||7));const n=new Date(a.getFullYear(),0,1);return Math.ceil(((a.getTime()-n.getTime())/864e5+1)/7)}getLabelForChart(e,a,n){return["From "+a[0]+" to "+a.pop()+" | From "+n[0]+" to "+n.pop()]}incrementDate(e,a){switch(a){case"day":e.setDate(e.getDate()+1);break;case"week":e.setDate(e.getDate()+7);break;case"month":e.setMonth(e.getMonth()+1);break;case"year":e.setFullYear(e.getFullYear()+1)}}static \u0275fac=function(a){return new(a||i)};static \u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function y(i,h){1&i&&t._UZ(0,"i",36)}function S(i,h){1&i&&t._UZ(0,"i",37)}const k=function(i,h){return{"btn-primary":i,"btn-danger":h}},F=function(i,h){return{"icon-positive":i,"icon-negative":h}},T=[{path:"",children:[{path:"",component:(()=>{class i{airtableService;authService;router;chartService;absoluteNumber;percentage;isPositive;isNegative;gradientStroke;chartColor="#FFFFFF";canvas;ctx;gradientFill;gradientChartOptionsConfiguration;gradientChartOptionsConfigurationWithNumbersAndGrid;chartBar;chartLine;Users=[];now=new Date;now1=new Date(this.now.getFullYear()+"-01-02");now2=new Date(this.now.getFullYear()+"-06-30");now3=new Date(this.now.getFullYear()+"-07-01");now4=new Date(this.now.getFullYear()+"-12-31");constructor(e,a,n,s){this.airtableService=e,this.authService=a,this.router=n,this.chartService=s}ngOnInit(){this.authService.checkConnection()?this.airtableService.getRecords().then(e=>{this.Users=e,this.initialisation()}):this.router.navigate(["/pages/lock"])}setupGradient(){this.gradientStroke=this.ctx.createLinearGradient(0,10,0,75),this.gradientStroke.addColorStop(0,"#6bd098"),this.gradientStroke.addColorStop(1,this.chartColor),this.gradientFill=this.ctx.createLinearGradient(0,10,0,75),this.gradientFill.addColorStop(0,"#f17e5d"),this.gradientFill.addColorStop(1,this.chartColor)}setupLineChart(){this.canvas=document.getElementById("chartLine"),this.ctx=this.canvas.getContext("2d"),this.setupGradient(),this.chartLine=new(C())(this.ctx,{type:"line",data:{labels:["W01/W27","W02/W28","W03/W29","W04/W30","W05/W31","W06/W32","W07/W33","W08/W34","W09/W35","W10/W36","W11/W37","W12/W38","W13/W39","W14/W40","W15/W41","W16/W42","W17/W43","W18/W44","W19/W45","W20/W46","W21/W47","W22/W48","W23/W49","W24/W50","W25/W51","W26/W52"],datasets:[{label:"Week 1 - Week 26",borderColor:"#6bd098",backgroundColor:this.gradientStroke,pointRadius:2,pointHoverRadius:5,borderWidth:3,data:Object.values(this.countDatesInRange(this.now1,this.now2,"week"))},{label:"Week 27 - Week 52",borderColor:"#f17e5d",backgroundColor:this.gradientFill,pointRadius:2,pointHoverRadius:5,borderWidth:3,data:Object.values(this.countDatesInRange(this.now3,this.now4,"week"))}]},options:{legend:{display:!0,position:"bottom"},tooltips:{enabled:!0},scales:{yAxes:[{ticks:{fontColor:"#9f9f9f",beginAtZero:!1,maxTicksLimit:5},gridLines:{drawBorder:!1,zeroLineColor:"transparent",color:"rgba(255,255,255,0.05)"}}],dataset:[{barPercentage:1.6,gridLines:{drawBorder:!1,color:"rgba(255,255,255,0.1)",zeroLineColor:"transparent",display:!1},ticks:{padding:20,fontColor:"#9f9f9f"}}]}}})}setupBarChart(){this.canvas=document.getElementById("activity"),this.ctx=this.canvas.getContext("2d"),this.chartBar=new(C())(this.ctx,{type:"bar",data:{datasets:[{label:"Week 1 - Week 26",borderColor:"#6bd098",fill:!0,backgroundColor:"#6bd098",hoverBorderColor:"#6bd098",borderWidth:8,data:[Object.values(this.countDatesInRange(this.now1,this.now2,"week")).reduce((e,a)=>e+a,0)]},{label:"Week 26 - Week 53",borderColor:"#f17e5d",fill:!0,backgroundColor:"#f17e5d",hoverBorderColor:"#f17e5d",borderWidth:8,data:[Object.values(this.countDatesInRange(this.now3,this.now4,"week")).reduce((e,a)=>e+a,0)]}]},options:{legend:{display:!0,position:"bottom"},scales:{yAxes:[{ticks:{fontColor:"#9f9f9f",fontStyle:"bold",beginAtZero:!0,maxTicksLimit:5,padding:20},gridLines:{zeroLineColor:"transparent",display:!0,drawBorder:!1,color:"#9f9f9f"}}],dataset:[{barPercentage:.4,gridLines:{zeroLineColor:"white",display:!1,drawBorder:!1,color:"transparent"},ticks:{padding:20,fontColor:"#9f9f9f",fontStyle:"bold"}}]}}})}initialisation(){this.setupLineChart(),this.setupBarChart();var e=this.chartBar.data.datasets[0].data[0],a=this.chartBar.data.datasets[1].data[0];this.absoluteNumber=a-e,this.percentage=Number((100*(a-e)/e).toFixed(2)),this.isPositive=this.percentage>=0,this.isNegative=this.percentage<0}realUpdate(){const e=document.getElementById("unit").value;e&&["day","week","month","year"].includes(e)&&this.updateCharts(e)}calculateNumbersAndPercentage(){const e=this.chartBar.data.datasets[0].data[0],a=this.chartBar.data.datasets[1].data[0];this.absoluteNumber=a-e,this.percentage=Number((100*(a-e)/e).toFixed(2)),this.isPositive=this.percentage>=0,this.isNegative=this.percentage<0}countDatesInRange(e,a,n){const s={},l={day:r=>`${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}-${r.getFullYear()}`,week:r=>`W${String(this.chartService.getISOWeek(r)).padStart(2,"0")}`,month:r=>`${String(r.getMonth()+1).padStart(2,"0")}-${r.getFullYear()}`,year:r=>`${r.getFullYear()}`}[n];for(let r=new Date(e);r<=a;this.chartService.incrementDate(r,n)){const o=l(r);s[o]=0}return this.Users.forEach(r=>{const o=new Date(r.date);if(o>=e&&o<=a){const u=l(o);s[u]++}}),s}updateCharts(e){const a=new Date(document.getElementById("startDate1").value),n=new Date(document.getElementById("endDate1").value),s=new Date(document.getElementById("startDate2").value),d=new Date(document.getElementById("endDate2").value);if(a&&n&&s&&d){const l=[Object.values(this.countDatesInRange(a,n,e)).reduce((v,m)=>v+m,0)];this.chartBar.data.datasets[0].data=l;const r=[Object.values(this.countDatesInRange(s,d,e)).reduce((v,m)=>v+m,0)];this.chartBar.data.datasets[1].data=r,this.absoluteNumber=r[0]-l[0],this.chartLine.data.datasets[0].data=Object.values(this.countDatesInRange(a,n,e)),this.chartLine.data.datasets[1].data=Object.values(this.countDatesInRange(s,d,e));const o=Object.keys(this.countDatesInRange(a,n,e)),u=Object.keys(this.countDatesInRange(s,d,e));this.chartBar.data.labels=this.chartService.getLabelForChart(e,o,u),this.chartBar.data.datasets[0].label=this.chartLine.data.datasets[0].label=this.chartService.getLabelForDataset(o),this.chartBar.data.datasets[1].label=this.chartLine.data.datasets[1].label=this.chartService.getLabelForDataset(u),this.chartLine.data.labels=this.chartService.mixLists(o,u),this.chartBar.update(),this.chartLine.update(),this.calculateNumbersAndPercentage()}}static \u0275fac=function(a){return new(a||i)(t.Y36(w.R),t.Y36(D.q),t.Y36(f.F0),t.Y36(Z))};static \u0275cmp=t.Xpm({type:i,selectors:[["charts-cmp"]],decls:63,vars:17,consts:[[1,"main-content"],[1,"row"],[1,"col-md-2"],["id","dateRangePicker"],["for","unit",2,"padding","10px"],["name","Unit","id","unit",2,"width","40%",3,"change"],["value","day"],["selected","selected","value","week"],["value","month"],["value","year"],[1,"col-md-5"],["for","startDate1",2,"padding","10px"],["type","date","id","startDate1",2,"width","30%",3,"value","change"],["for","endDate1",2,"padding","10px"],["type","date","id","endDate1",2,"width","30%",3,"value","change"],["for","startDate2",2,"padding","10px"],["type","date","id","startDate2",2,"width","30%",3,"value","change"],["for","endDate2",2,"padding","10px"],["type","date","id","endDate2",2,"width","30%",3,"value","change"],[1,"col-md-12"],[1,"card"],[1,"card-header"],[1,"card-title","text-center"],[1,"card-body"],["id","chartLine"],[1,"col-md-6"],[1,"card","car-chart"],["id","activity"],[1,"card","card-pricing"],[1,"row","align-items-center"],[1,"col-sm-12"],[1,"card-title"],["href","javascript:void(0)",1,"btn","btn-round","btn-lg",3,"ngClass"],[1,"card-icon",2,"transform","scale(0.5)",3,"ngClass"],["class","nc-icon nc-minimal-up text-success",4,"ngIf","ngIfElse"],["negativeIcon",""],[1,"nc-icon","nc-minimal-up","text-success"],[1,"nc-icon","nc-minimal-down","text-danger"]],template:function(a,n){if(1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),t._uU(5,"Unit: "),t.qZA(),t.TgZ(6,"select",5),t.NdJ("change",function(){return n.realUpdate()}),t.TgZ(7,"option",6),t._uU(8,"Day"),t.qZA(),t.TgZ(9,"option",7),t._uU(10,"Week"),t.qZA(),t.TgZ(11,"option",8),t._uU(12,"Month"),t.qZA(),t.TgZ(13,"option",9),t._uU(14,"Year"),t.qZA()()()(),t.TgZ(15,"div",10)(16,"div",3)(17,"label",11),t._uU(18,"From: "),t.qZA(),t.TgZ(19,"input",12),t.NdJ("change",function(){return n.realUpdate()}),t.qZA(),t.TgZ(20,"label",13),t._uU(21," to "),t.qZA(),t.TgZ(22,"input",14),t.NdJ("change",function(){return n.realUpdate()}),t.qZA()()(),t.TgZ(23,"div",10)(24,"label",15),t._uU(25,"From: "),t.qZA(),t.TgZ(26,"input",16),t.NdJ("change",function(){return n.realUpdate()}),t.qZA(),t.TgZ(27,"label",17),t._uU(28," to "),t.qZA(),t.TgZ(29,"input",18),t.NdJ("change",function(){return n.realUpdate()}),t.qZA()(),t.TgZ(30,"div",19)(31,"div",20)(32,"div",21)(33,"h5",22),t._uU(34,"Comparison Table"),t.qZA()(),t.TgZ(35,"div",23),t._UZ(36,"canvas",24),t.qZA()()()(),t.TgZ(37,"div",1)(38,"div",25)(39,"div",26)(40,"div",21)(41,"h5",22),t._uU(42,"Gap Difference"),t.qZA()(),t.TgZ(43,"div",23),t._UZ(44,"canvas",27),t.qZA()()(),t.TgZ(45,"div",25)(46,"div",28)(47,"div",21)(48,"h5",22),t._uU(49,"Numerical comparative"),t.qZA()(),t.TgZ(50,"div",23)(51,"div",29)(52,"div",30)(53,"h2",31),t._uU(54),t.qZA()(),t.TgZ(55,"div",30)(56,"a",32),t._uU(57),t.qZA()(),t.TgZ(58,"div",30)(59,"div",33),t.YNc(60,y,1,0,"i",34),t.YNc(61,S,1,0,"ng-template",null,35,t.W1O),t.qZA()()()()()()()()),2&a){const s=t.MAs(62);t.xp6(19),t.Q6J("value",n.now1.toISOString().split("T")[0]),t.xp6(3),t.Q6J("value",n.now2.toISOString().split("T")[0]),t.xp6(4),t.Q6J("value",n.now3.toISOString().split("T")[0]),t.xp6(3),t.Q6J("value",n.now4.toISOString().split("T")[0]),t.xp6(25),t.hij(" ",n.absoluteNumber,""),t.xp6(2),t.Q6J("ngClass",t.WLB(11,k,n.isPositive,n.isNegative)),t.xp6(1),t.AsE(" ",n.isPositive?"+":"","",n.percentage,"% "),t.xp6(2),t.Q6J("ngClass",t.WLB(14,F,n.isPositive,n.isNegative)),t.xp6(1),t.Q6J("ngIf",n.isPositive)("ngIfElse",s)}},dependencies:[g.mk,g.O5,p.YN,p.Kr],encapsulation:2})}return i})()}]}];let I=(()=>{class i{static \u0275fac=function(a){return new(a||i)};static \u0275mod=t.oAB({type:i});static \u0275inj=t.cJS({imports:[g.ez,f.Bz.forChild(T),p.u5]})}return i})()}}]);
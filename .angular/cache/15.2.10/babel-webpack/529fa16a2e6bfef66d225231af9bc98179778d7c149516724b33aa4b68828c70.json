{"ast":null,"code":"import _asyncToGenerator from \"/Users/ricardoda-silva/Desktop/Project/RiAn/AnRi v2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ConsoleLogger } from '@aws-amplify/core';\nimport { assertIdentityPoolIdConfig } from '@aws-amplify/core/internals/utils';\nimport { getAuthStorageKeys } from '../tokenProvider/TokenStore.mjs';\nimport { IdentityIdStorageKeys } from './types.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nconst logger = new ConsoleLogger('DefaultIdentityIdStore');\nclass DefaultIdentityIdStore {\n  setAuthConfig(authConfigParam) {\n    assertIdentityPoolIdConfig(authConfigParam.Cognito);\n    this.authConfig = authConfigParam;\n    this._authKeys = createKeysForAuthStorage('Cognito', authConfigParam.Cognito.identityPoolId);\n  }\n  constructor(keyValueStorage) {\n    this._authKeys = {};\n    this.keyValueStorage = keyValueStorage;\n  }\n  loadIdentityId() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      assertIdentityPoolIdConfig(_this.authConfig?.Cognito);\n      try {\n        if (_this._primaryIdentityId) {\n          return {\n            id: _this._primaryIdentityId,\n            type: 'primary'\n          };\n        } else {\n          const storedIdentityId = yield _this.keyValueStorage.getItem(_this._authKeys.identityId);\n          if (storedIdentityId) {\n            return {\n              id: storedIdentityId,\n              type: 'guest'\n            };\n          }\n          return null;\n        }\n      } catch (err) {\n        logger.log('Error getting stored IdentityId.', err);\n        return null;\n      }\n    })();\n  }\n  storeIdentityId(identity) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      assertIdentityPoolIdConfig(_this2.authConfig?.Cognito);\n      if (identity.type === 'guest') {\n        _this2.keyValueStorage.setItem(_this2._authKeys.identityId, identity.id);\n        // Clear in-memory storage of primary identityId\n        _this2._primaryIdentityId = undefined;\n      } else {\n        _this2._primaryIdentityId = identity.id;\n        // Clear locally stored guest id\n        _this2.keyValueStorage.removeItem(_this2._authKeys.identityId);\n      }\n    })();\n  }\n  clearIdentityId() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      _this3._primaryIdentityId = undefined;\n      yield _this3.keyValueStorage.removeItem(_this3._authKeys.identityId);\n    })();\n  }\n}\nconst createKeysForAuthStorage = (provider, identifier) => {\n  return getAuthStorageKeys(IdentityIdStorageKeys)(`com.amplify.${provider}`, identifier);\n};\nexport { DefaultIdentityIdStore };\n//# sourceMappingURL=IdentityIdStore.mjs.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}
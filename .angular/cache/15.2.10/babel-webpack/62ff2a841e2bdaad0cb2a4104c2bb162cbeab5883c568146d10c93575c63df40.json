{"ast":null,"code":"import _asyncToGenerator from \"/Users/ricardoda-silva/Desktop/Project/RiAn/AnRi v2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { assertTokenProviderConfig } from '@aws-amplify/core/internals/utils';\nimport { getAuthStorageKeys } from '../tokenProvider/TokenStore.mjs';\nimport { OAuthStorageKeys } from './types.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nconst V5_HOSTED_UI_KEY = 'amplify-signin-with-hostedUI';\nconst name = 'CognitoIdentityServiceProvider';\nclass DefaultOAuthStore {\n  constructor(keyValueStorage) {\n    this.keyValueStorage = keyValueStorage;\n  }\n  clearOAuthInflightData() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      assertTokenProviderConfig(_this.cognitoConfig);\n      const authKeys = createKeysForAuthStorage(name, _this.cognitoConfig.userPoolClientId);\n      yield Promise.all([_this.keyValueStorage.removeItem(authKeys.inflightOAuth), _this.keyValueStorage.removeItem(authKeys.oauthPKCE), _this.keyValueStorage.removeItem(authKeys.oauthState)]);\n    })();\n  }\n  clearOAuthData() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      assertTokenProviderConfig(_this2.cognitoConfig);\n      const authKeys = createKeysForAuthStorage(name, _this2.cognitoConfig.userPoolClientId);\n      yield _this2.clearOAuthInflightData();\n      yield _this2.keyValueStorage.removeItem(V5_HOSTED_UI_KEY); // remove in case a customer migrated an App from v5 to v6\n      return _this2.keyValueStorage.removeItem(authKeys.oauthSignIn);\n    })();\n  }\n  loadOAuthState() {\n    assertTokenProviderConfig(this.cognitoConfig);\n    const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n    return this.keyValueStorage.getItem(authKeys.oauthState);\n  }\n  storeOAuthState(state) {\n    assertTokenProviderConfig(this.cognitoConfig);\n    const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n    return this.keyValueStorage.setItem(authKeys.oauthState, state);\n  }\n  loadPKCE() {\n    assertTokenProviderConfig(this.cognitoConfig);\n    const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n    return this.keyValueStorage.getItem(authKeys.oauthPKCE);\n  }\n  storePKCE(pkce) {\n    assertTokenProviderConfig(this.cognitoConfig);\n    const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n    return this.keyValueStorage.setItem(authKeys.oauthPKCE, pkce);\n  }\n  setAuthConfig(authConfigParam) {\n    this.cognitoConfig = authConfigParam;\n  }\n  loadOAuthInFlight() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      assertTokenProviderConfig(_this3.cognitoConfig);\n      const authKeys = createKeysForAuthStorage(name, _this3.cognitoConfig.userPoolClientId);\n      return (yield _this3.keyValueStorage.getItem(authKeys.inflightOAuth)) === 'true';\n    })();\n  }\n  storeOAuthInFlight(inflight) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      assertTokenProviderConfig(_this4.cognitoConfig);\n      const authKeys = createKeysForAuthStorage(name, _this4.cognitoConfig.userPoolClientId);\n      yield _this4.keyValueStorage.setItem(authKeys.inflightOAuth, `${inflight}`);\n    })();\n  }\n  loadOAuthSignIn() {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      assertTokenProviderConfig(_this5.cognitoConfig);\n      const authKeys = createKeysForAuthStorage(name, _this5.cognitoConfig.userPoolClientId);\n      const isLegacyHostedUISignIn = yield _this5.keyValueStorage.getItem(V5_HOSTED_UI_KEY);\n      const [isOAuthSignIn, preferPrivateSession] = (yield _this5.keyValueStorage.getItem(authKeys.oauthSignIn))?.split(',') ?? [];\n      return {\n        isOAuthSignIn: isOAuthSignIn === 'true' || isLegacyHostedUISignIn === 'true',\n        preferPrivateSession: preferPrivateSession === 'true'\n      };\n    })();\n  }\n  storeOAuthSignIn(oauthSignIn, preferPrivateSession = false) {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      assertTokenProviderConfig(_this6.cognitoConfig);\n      const authKeys = createKeysForAuthStorage(name, _this6.cognitoConfig.userPoolClientId);\n      yield _this6.keyValueStorage.setItem(authKeys.oauthSignIn, `${oauthSignIn},${preferPrivateSession}`);\n    })();\n  }\n}\nconst createKeysForAuthStorage = (provider, identifier) => {\n  return getAuthStorageKeys(OAuthStorageKeys)(provider, identifier);\n};\nexport { DefaultOAuthStore };\n//# sourceMappingURL=signInWithRedirectStore.mjs.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}
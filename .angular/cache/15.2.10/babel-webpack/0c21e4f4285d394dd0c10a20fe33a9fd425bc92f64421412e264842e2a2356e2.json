{"ast":null,"code":"import _asyncToGenerator from \"/Users/ricardoda-silva/Desktop/Project/RiAn/AnRi v2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { createMachine, sendUpdate } from 'xstate';\nimport { sendUserAttributeVerificationCode, confirmUserAttribute } from 'aws-amplify/auth';\nimport { runValidators } from '../../../validators/index.mjs';\nimport ACTIONS from '../actions.mjs';\nimport { defaultServices } from '../defaultServices.mjs';\nfunction verifyUserAttributesActor() {\n  return createMachine({\n    id: 'verifyUserAttributesActor',\n    initial: 'selectUserAttributes',\n    predictableActionArguments: true,\n    states: {\n      selectUserAttributes: {\n        initial: 'edit',\n        exit: ['clearError', 'clearTouched', 'sendUpdate'],\n        states: {\n          edit: {\n            entry: 'sendUpdate',\n            on: {\n              SUBMIT: {\n                actions: 'handleSubmit',\n                target: 'submit'\n              },\n              SKIP: {\n                target: '#verifyUserAttributesActor.resolved'\n              },\n              CHANGE: {\n                actions: 'handleInput'\n              }\n            }\n          },\n          submit: {\n            tags: 'pending',\n            entry: ['clearError', 'sendUpdate'],\n            invoke: {\n              src: 'sendUserAttributeVerificationCode',\n              onDone: {\n                actions: ['setSelectedUserAttribute', 'setCodeDeliveryDetails'],\n                target: '#verifyUserAttributesActor.confirmVerifyUserAttribute'\n              },\n              onError: {\n                actions: 'setRemoteError',\n                target: 'edit'\n              }\n            }\n          }\n        }\n      },\n      confirmVerifyUserAttribute: {\n        initial: 'edit',\n        exit: ['clearError', 'clearFormValues', 'clearTouched'],\n        states: {\n          edit: {\n            entry: 'sendUpdate',\n            on: {\n              SUBMIT: {\n                actions: 'handleSubmit',\n                target: 'submit'\n              },\n              SKIP: '#verifyUserAttributesActor.resolved',\n              CHANGE: {\n                actions: 'handleInput'\n              }\n            }\n          },\n          submit: {\n            tags: 'pending',\n            entry: ['clearError', 'sendUpdate'],\n            invoke: {\n              src: 'confirmVerifyUserAttribute',\n              onDone: {\n                actions: ['setConfirmAttributeCompleteStep', 'clearSelectedUserAttribute'],\n                target: '#verifyUserAttributesActor.resolved'\n              },\n              onError: {\n                actions: 'setRemoteError',\n                target: 'edit'\n              }\n            }\n          }\n        }\n      },\n      resolved: {\n        type: 'final',\n        data: ({\n          step\n        }) => ({\n          step\n        })\n      }\n    }\n  }, {\n    // sendUpdate is a HOC\n    actions: {\n      ...ACTIONS,\n      sendUpdate: sendUpdate()\n    },\n    services: {\n      sendUserAttributeVerificationCode({\n        formValues: {\n          unverifiedAttr\n        }\n      }) {\n        const input = {\n          userAttributeKey: unverifiedAttr\n        };\n        return sendUserAttributeVerificationCode(input);\n      },\n      confirmVerifyUserAttribute({\n        formValues: {\n          confirmation_code: confirmationCode\n        },\n        selectedUserAttribute\n      }) {\n        return _asyncToGenerator(function* () {\n          const input = {\n            confirmationCode,\n            userAttributeKey: selectedUserAttribute\n          };\n          return confirmUserAttribute(input);\n        })();\n      },\n      validateFields(context) {\n        return _asyncToGenerator(function* () {\n          return runValidators(context.formValues, context.touched, context.passwordSettings, [defaultServices.validateFormPassword, defaultServices.validateConfirmPassword]);\n        })();\n      }\n    }\n  });\n}\nexport { verifyUserAttributesActor };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}